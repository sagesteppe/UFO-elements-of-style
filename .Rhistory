ggnewscale::new_scale_fill() +
geom_raster(data = fqi_pred_df, aes(x = x, y = y, fill = mean),
interpolate = F) +
scale_fill_viridis_c('Mean C', option = "C", direction = -1,
limits = c(1, 7) ) +
ggnewscale::new_scale_fill() +
geom_point(data = fqi_plots, aes(fill = mcoc_r, size = fqi_r, geometry = geometry),
stat = "sf_coordinates", shape = 21) +
scale_fill_viridis_c('Mean C', option = "C", alpha = 0.7, direction = -1,
limits = c(1,7),  guide = "none") +
scale_size_binned('FQI') +
theme_void() +
theme(legend.position = "right")  +
geom_sf(data = rivers, alpha = 0.5, color = 'blue') +
coord_sf(xlim = c(bbox['xmin'], bbox['xmax']),
ylim = c(bbox['ymin'], bbox['ymax'])) +
labs(title = 'Invasive Species Index') +
geom_sf_label(data = places, aes(label = NAME), inherit.aes = F,
alpha = 0.5, label.size  = NA) +
annotation_scale(location = "bl",
pad_x = unit(0.2, "in"), pad_y = unit(0.15, "in"),
width_hint = 0.2) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.05, "in"), pad_y = unit(0.25, "in"),
style = north_arrow_minimal)
hill <- rast(
file.path(p2carto, raster_data[grep('Hill.*fine', raster_data)])
)
hill <- crop(hill,  ext(terra::vect(fqi_plots)))
hill <- aggregate(hill, 10)
hillshade <- as.data.frame(hill, xy = T)
ggplot() +
geom_raster(data = hillshade, aes(x = x, y = y, fill = lyr1),
interpolate = F)  +
scale_fill_gradient(low = "grey50", high = "grey100") +
guides(fill = 'none') +
theme_void(base_size = 9) +
theme(plot.title = element_text(hjust = 0.65),
legend.title = element_text(hjust = 0.5, size = 8),
legend.position = 'bottom',
legend.key.size = unit(0.3, 'cm'),
legend.spacing.y = unit(0.2, 'pt'),
legend.spacing.x = unit(0.2, 'pt'),
plot.margin = unit(c(0,-2.5,0,0), "lines"),
legend.text = element_text(size = 6,
margin = margin(l = 0, unit = "pt"))) +
ggnewscale::new_scale_fill() +
geom_raster(data = fqi_pred_df, aes(x = x, y = y, fill = mean),
interpolate = F) +
scale_fill_viridis_c('Mean C', option = "C", direction = -1,
limits = c(1, 7) ) +
ggnewscale::new_scale_fill() +
geom_point(data = fqi_plots, aes(fill = mcoc_r, size = fqi_r, geometry = geometry),
stat = "sf_coordinates", shape = 21) +
scale_fill_viridis_c('Mean C', option = "C", alpha = 0.7, direction = -1,
limits = c(1,7),  guide = "none") +
scale_size_binned('FQI') +
theme_void() +
theme(legend.position = "right")  +
geom_sf(data = rivers, alpha = 0.5, color = 'blue') +
coord_sf(xlim = c(bbox['xmin'], bbox['xmax']),
ylim = c(bbox['ymin'], bbox['ymax'])) +
labs(title = 'Invasive Species Index') +
geom_sf_label(data = places, aes(label = NAME), inherit.aes = F,
alpha = 0.5, label.size  = NA) +
annotation_scale(location = "bl",
pad_x = unit(0.2, "in"), pad_y = unit(0.15, "in"),
width_hint = 0.2) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.05, "in"), pad_y = unit(0.25, "in"),
style = north_arrow_minimal)
ggplot() +
geom_raster(data = hillshade, aes(x = x, y = y, fill = lyr1),
interpolate = F)  +
scale_fill_gradient(low = "grey50", high = "grey100") +
guides(fill = 'none') +
theme_void(base_size = 9) +
theme(plot.title = element_text(hjust = 0.65),
legend.title = element_text(hjust = 0.5, size = 8),
legend.position = 'bottom',
legend.key.size = unit(0.3, 'cm'),
legend.spacing.y = unit(0.2, 'pt'),
legend.spacing.x = unit(0.2, 'pt'),
plot.margin = unit(c(0,-2.5,0,0), "lines"),
legend.text = element_text(size = 6,
margin = margin(l = 0, unit = "pt"))) +
ggnewscale::new_scale_fill() +
geom_raster(data = fqi_pred_df_noXY, aes(x = x, y = y, fill = mean),
interpolate = F) +
scale_fill_viridis_c('Mean C', option = "C", direction = -1,
limits = c(1, 7) ) +
ggnewscale::new_scale_fill() +
geom_point(data = fqi_plots, aes(fill = mcoc_r, size = fqi_r, geometry = geometry),
stat = "sf_coordinates", shape = 21) +
scale_fill_viridis_c('Mean C', option = "C", alpha = 0.7, direction = -1,
limits = c(1,7),  guide = "none") +
scale_size_binned('FQI') +
theme_void() +
theme(legend.position = "right")  +
geom_sf(data = rivers, alpha = 0.5, color = 'blue') +
coord_sf(xlim = c(bbox['xmin'], bbox['xmax']),
ylim = c(bbox['ymin'], bbox['ymax'])) +
labs(title = 'Invasive Species Index') +
geom_sf_label(data = places, aes(label = NAME), inherit.aes = F,
alpha = 0.5, label.size  = NA) +
annotation_scale(location = "bl",
pad_x = unit(0.2, "in"), pad_y = unit(0.15, "in"),
width_hint = 0.2) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.05, "in"), pad_y = unit(0.25, "in"),
style = north_arrow_minimal)
Pad <- st_crop(padus, bbox) %>%
filter(!Own_Name %in% c('LOC', 'JNT', 'TRIB', 'DOD', 'USBR', 'FWS', 'BLM'))
public_lands_pal1 <- public_lands_pal
names(public_lands_pal1)[11] <- 'Local-State'
plp <- public_lands_pal[c(unique(Pad$Own_Name))]
plp <- plp[order(names(plp))]
plp <- plp[!is.na(plp)]
ggplot() +
geom_raster(data = hillshade, aes(x = x, y = y, fill = lyr1),
interpolate = F)  +
scale_fill_gradient(low = "grey50", high = "grey100") +
guides(fill = 'none') +
theme_void(base_size = 9) +
theme(plot.title = element_text(hjust = 0.65),
legend.title = element_text(hjust = 0.5, size = 8),
legend.position = 'bottom',
legend.key.size = unit(0.3, 'cm'),
legend.spacing.y = unit(0.2, 'pt'),
legend.spacing.x = unit(0.2, 'pt'),
plot.margin = unit(c(0,-2.5,0,0), "lines"),
legend.text = element_text(size = 6,
margin = margin(l = 0, unit = "pt"))) +
ggnewscale::new_scale_fill() +
geom_raster(data = fqi_pred_df_noXY, aes(x = x, y = y, fill = mean),
interpolate = F) +
scale_fill_viridis_c('Mean C', option = "C", direction = -1,
limits = c(1, 7) ) +
ggnewscale::new_scale_fill() +
geom_sf(data = Pad, aes(fill = Own_Name), alpha = 0.7, color = NA) +
scale_fill_manual('Management', values = plp) +
geom_point(data = fqi_plots, aes(fill = mcoc_r, size = fqi_r, geometry = geometry),
stat = "sf_coordinates", shape = 21) +
scale_fill_viridis_c('Mean C', option = "C", alpha = 0.7, direction = -1,
limits = c(1,7),  guide = "none") +
scale_size_binned('FQI') +
theme_void() +
theme(legend.position = "right")  +
geom_sf(data = rivers, alpha = 0.5, color = 'blue') +
coord_sf(xlim = c(bbox['xmin'], bbox['xmax']),
ylim = c(bbox['ymin'], bbox['ymax'])) +
labs(title = 'Invasive Species Index') +
geom_sf_label(data = places, aes(label = NAME), inherit.aes = F,
alpha = 0.5, label.size  = NA) +
annotation_scale(location = "bl",
pad_x = unit(0.2, "in"), pad_y = unit(0.15, "in"),
width_hint = 0.2) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.05, "in"), pad_y = unit(0.25, "in"),
style = north_arrow_minimal)
ggplot() +
geom_raster(data = hillshade, aes(x = x, y = y, fill = lyr1),
interpolate = F)  +
scale_fill_gradient(low = "grey50", high = "grey100") +
guides(fill = 'none') +
theme_void(base_size = 9) +
theme(plot.title = element_text(hjust = 0.65),
legend.title = element_text(hjust = 0.5, size = 8),
legend.position = 'bottom',
legend.key.size = unit(0.3, 'cm'),
legend.spacing.y = unit(0.2, 'pt'),
legend.spacing.x = unit(0.2, 'pt'),
plot.margin = unit(c(0,-2.5,0,0), "lines"),
legend.text = element_text(size = 6,
margin = margin(l = 0, unit = "pt"))) +
ggnewscale::new_scale_fill() +
geom_raster(data = fqi_pred_df_noXY, aes(x = x, y = y, fill = mean),
interpolate = F) +
scale_fill_viridis_c('Mean C', option = "C", direction = -1,
limits = c(1, 7) ) +
ggnewscale::new_scale_fill() +
geom_sf(data = Pad, aes(color = Own_Name), alpha = 0.7, color = NA) +
scale_fill_manual('Management', values = plp) +
geom_point(data = fqi_plots, aes(fill = mcoc_r, size = fqi_r, geometry = geometry),
stat = "sf_coordinates", shape = 21) +
scale_fill_viridis_c('Mean C', option = "C", alpha = 0.7, direction = -1,
limits = c(1,7),  guide = "none") +
scale_size_binned('FQI') +
theme_void() +
theme(legend.position = "right")  +
geom_sf(data = rivers, alpha = 0.5, color = 'blue') +
coord_sf(xlim = c(bbox['xmin'], bbox['xmax']),
ylim = c(bbox['ymin'], bbox['ymax'])) +
labs(title = 'Invasive Species Index') +
geom_sf_label(data = places, aes(label = NAME), inherit.aes = F,
alpha = 0.5, label.size  = NA) +
annotation_scale(location = "bl",
pad_x = unit(0.2, "in"), pad_y = unit(0.15, "in"),
width_hint = 0.2) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.05, "in"), pad_y = unit(0.25, "in"),
style = north_arrow_minimal)
plp
padus
Pad
gc()
library(sf)
library(tidyverse)
library(ggspatial)
library(terra)
library(ggnewscale)
library(cowplot)
p2carto <- '/media/sagesteppe/ExternalHD/UFO_cartography'
vector_data <- list.files(p2carto, recursive = T, pattern = 'shp$')
# aim <- st_read(
#  file.path(p2carto, vector_data[grep('*Plots*', vector_data)]), quiet = T)
# acec <- st_read(
#  file.path(p2carto, vector_data[grep('*ACEC*', vector_data)]), quiet = T)
# allotments <- st_read(
#   file.path(p2carto, vector_data[grep('*Grazing*', vector_data)]), quiet = T)
administrative_boundaries <- st_read(
file.path(p2carto, vector_data[grep('*admu_', vector_data)]), quiet = T)
# grouse <- st_read(
#  file.path(p2carto, vector_data[grep('*Grouse*', vector_data)]), quiet = T)
# gtlf_roads <- st_read(
#  file.path(p2carto, vector_data[grep('*GTLF*', vector_data)]), quiet = T)
padus <- st_read(
file.path(p2carto, vector_data[grep('PAD.*Fee*', vector_data)]), quiet = T)
mask <- st_read(
file.path(p2carto, vector_data[grep('*mask*', vector_data)]), quiet = T)
#nm_and_nca <- st_read(
#  file.path(p2carto, vector_data[grep('*NCA*', vector_data)]), quiet = T)
streams <- st_read(
file.path(p2carto, vector_data[grep('*NHD_Streams*', vector_data)]), quiet = T)
rivers <- st_read(
file.path(p2carto, vector_data[grep('*NHD_Rivers*', vector_data)]), quiet = T) %>%
st_zm()
#tabeguache <- st_read(
#  file.path(p2carto, vector_data[grep('*Tabeguache*', vector_data)]), quiet = T)
#wa <- st_read(
#  file.path(p2carto, vector_data[grep('*unofficial*', vector_data)]), quiet = T)
#wsa <- st_read(
#  file.path(p2carto, vector_data[grep('*WSA*', vector_data)]), quiet = T)
bbox <- filter(administrative_boundaries, FIELD_O == 'UNCOMPAHGRE') %>%
st_bbox()
ext_ter <- filter(administrative_boundaries, FIELD_O == 'UNCOMPAHGRE') %>%
terra::vect() |> ext()
# raster data
raster_data <- list.files(p2carto, recursive = T, pattern = 'tif$')
hill <- rast(
file.path(p2carto, raster_data[grep('Hill.*fine', raster_data)])
)
public_lands_pal <- setNames(
c( # colours
rgb(254, 230, 121, max = 255), # BLM
rgb(204, 235, 197, max = 255), # USFS
rgb(202, 189, 220, max = 255), # NPS
rgb(127, 204, 167, max = 255), # FWS
rgb(255, 255, 179, max = 255), # USBR
rgb(253, 180, 108, max = 255), # TRIB
rgb(251, 180, 206, max = 255), # DOD
rgb(228, 196, 159, max = 255), # OTHF
rgb(179, 227, 238, max = 255), # SLB
rgb(255, 255, 255, max = 255), # PVT
rgb(143, 181, 190, max = 255) # CITY CNTY
),
c( # names
'BLM', 'USFS', 'NPS', 'FWS', 'USBR', 'TRIB', 'DOD', 'OTHF', 'SLB', 'Private', 'Local-State')
)
setwd('/media/sagesteppe/ExternalHD/UFO_elements_of_style')
p2pd <- '/media/sagesteppe/ExternalHD/UFO_Plant_Diversity/results/'
fqi_plots <- st_read(
file.path(p2pd, 'FQI_values.shp') )
fqi_prediction <- rast(
file.path(p2pd, 'predicted_FQI.tif')
)
fqi_no_xy <- rast(
file.path(p2pd, 'predicted_FQI_noXY.tif')
)
fqi_noXY_prediction <- crop(fqi_no_xy, ext(mask))
fqi_pred_df_noXY <- as.data.frame(fqi_noXY_prediction, xy = T)
hill <- crop(hill,  ext(mask))
hill <- aggregate(hill, 10)
hillshade <- as.data.frame(hill, xy = T)
bbox <- st_bbox(fqi_plots)
bbox <- st_bbox(
setNames(c(bbox['xmin'] - 2500, bbox['ymin'] - 2500, bbox['xmax'] + 2500,
bbox['ymax'] + 2500),
c('xmin', 'ymin', 'xmax', 'ymax' ))
)
fqi_noXY_prediction <- crop(fqi_no_xy, bbox)
fqi_pred_df_noXY <- as.data.frame(fqi_noXY_prediction, xy = T)
rivers <- st_crop(rivers, bbox)
mask <- st_crop(mask, bbox)
places <- tigris::places(state = 'CO') %>%
vect() %>%
project(., crs(fqi_prediction)) %>%
crop(., ext(fqi_prediction)) %>%
st_as_sf() %>%
st_point_on_surface() %>%
dplyr::select(NAME) %>%
filter(NAME %in% c('Nucla', 'Cedaredge', 'Montrose', 'Ridgway',
'Crawford', 'Paonia', 'Olathe'))
CO_roads <- tigris::roads(state = 'CO',
county = c('Montrose', 'Delta', 'Ouray',
'San Miguel', 'Mesa')) %>%
filter(RTTYP %in% c('U', 'S')) %>%
st_transform(st_crs(fqi_prediction)) %>%
st_crop(., bbox) %>%
st_simplify() %>%
dplyr::select(geometry) %>%
st_cast('LINESTRING') %>%
st_as_sfc()
non_ufo_blm <-  st_crop(padus, bbox) %>%
filter(Own_Name %in% c( 'BLM')) %>%
st_intersection(., mask)
Pad <- st_crop(padus, bbox) %>%
filter(!Own_Name %in% c('LOC', 'JNT', 'TRIB', 'DOD', 'USBR', 'FWS', 'BLM')) %>%
bind_rows(., non_ufo_blm)
public_lands_pal1 <- public_lands_pal
names(public_lands_pal1)[11] <- 'Local-State'
plp <- public_lands_pal[c(unique(Pad$Own_Name))]
plp <- plp[order(names(plp))]
plp <- plp[!is.na(plp)]
fqi <- ggplot() +
geom_raster(data = hillshade, aes(x = x, y = y, fill = lyr1),
interpolate = F)  +
scale_fill_gradient(low = "grey50", high = "grey100") +
guides(fill = 'none') +
theme_void(base_size = 9) +
theme(plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5, size = 8),
legend.position = 'bottom',
legend.key.size = unit(0.5, 'cm'),
legend.spacing.y = unit(2, 'pt'),
legend.spacing.x = unit(5, 'pt'),
legend.text = element_text(size = 6,
margin = margin(l = 0, unit = "pt"))) +
ggnewscale::new_scale_fill() +
geom_sf(data = Pad, aes(fill = Own_Name), alpha = 0.7, color = NA) +
scale_fill_manual('Management', values = plp) +
ggnewscale::new_scale_fill() +
geom_raster(data = fqi_pred_df_noXY, aes(x = x, y = y, fill = sum),
interpolate = F) +
scale_fill_viridis_c('Mean C', option = "C", direction = -1,
limits = c(1, 7) ) +
ggnewscale::new_scale_fill() +
geom_point(data = fqi_plots, aes(fill = mcoc_r, size = fqi_r,
geometry = geometry),
stat = "sf_coordinates", shape = 21) +
scale_fill_viridis_c('Mean C', option = "C", alpha = 0.7, direction = -1,
limits = c(1,7),  guide = "none") +
scale_size_binned('FQI') +
geom_sf(data = rivers, alpha = 0.5, color = 'blue') +
geom_sf(data = CO_roads, alpha = 0.5, color = 'black') +
coord_sf(xlim = c(bbox['xmin'], bbox['xmax']),
ylim = c(bbox['ymin'], bbox['ymax'])) +
labs(title = 'Measured and Predicted Floristic Quality') +
geom_sf_label(data = places, aes(label = NAME), inherit.aes = F,
alpha = 0.5, label.size  = NA) +
annotation_scale(location = "bl",
pad_x = unit(0.4, "in"), pad_y = unit(0.3, "in"),
width_hint = 0.2) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.3, "in"), pad_y = unit(0.5, "in"),
style = north_arrow_minimal)
fqi
hill <- crop(hill,  bbox)
hill <- aggregate(hill, 10)
hillshade <- as.data.frame(hill, xy = T)
hill <- rast(
file.path(p2carto, raster_data[grep('Hill.*fine', raster_data)])
)
hill <- crop(hill,  bbox)
hill <- aggregate(hill, 10)
hillshade <- as.data.frame(hill, xy = T)
fqi <- ggplot() +
geom_raster(data = hillshade, aes(x = x, y = y, fill = lyr1),
interpolate = F)  +
scale_fill_gradient(low = "grey50", high = "grey100") +
guides(fill = 'none') +
theme_void(base_size = 9) +
theme(plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5, size = 8),
legend.position = 'bottom',
legend.key.size = unit(0.5, 'cm'),
legend.spacing.y = unit(2, 'pt'),
legend.spacing.x = unit(5, 'pt'),
legend.text = element_text(size = 6,
margin = margin(l = 0, unit = "pt"))) +
ggnewscale::new_scale_fill() +
geom_sf(data = Pad, aes(fill = Own_Name), alpha = 0.7, color = NA) +
scale_fill_manual('Management', values = plp) +
ggnewscale::new_scale_fill() +
geom_raster(data = fqi_pred_df_noXY, aes(x = x, y = y, fill = sum),
interpolate = F) +
scale_fill_viridis_c('Mean C', option = "C", direction = -1,
limits = c(1, 7) ) +
ggnewscale::new_scale_fill() +
geom_point(data = fqi_plots, aes(fill = mcoc_r, size = fqi_r,
geometry = geometry),
stat = "sf_coordinates", shape = 21) +
scale_fill_viridis_c('Mean C', option = "C", alpha = 0.7, direction = -1,
limits = c(1,7),  guide = "none") +
scale_size_binned('FQI') +
geom_sf(data = rivers, alpha = 0.5, color = 'blue') +
geom_sf(data = CO_roads, alpha = 0.5, color = 'black') +
coord_sf(xlim = c(bbox['xmin'], bbox['xmax']),
ylim = c(bbox['ymin'], bbox['ymax'])) +
labs(title = 'Measured and Predicted Floristic Quality') +
geom_sf_label(data = places, aes(label = NAME), inherit.aes = F,
alpha = 0.5, label.size  = NA) +
annotation_scale(location = "bl",
pad_x = unit(0.4, "in"), pad_y = unit(0.3, "in"),
width_hint = 0.2) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.3, "in"), pad_y = unit(0.5, "in"),
style = north_arrow_minimal)
fqi
fqi <- ggplot() +
geom_raster(data = hillshade, aes(x = x, y = y, fill = lyr1),
interpolate = F)  +
scale_fill_gradient(low = "grey50", high = "grey100") +
guides(fill = 'none') +
theme_void(base_size = 9) +
theme(plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5, size = 8),
legend.position = 'bottom',
legend.key.size = unit(0.5, 'cm'),
legend.spacing.y = unit(2, 'pt'),
legend.spacing.x = unit(5, 'pt'),
legend.text = element_text(size = 6,
margin = margin(l = 0, unit = "pt"))) +
ggnewscale::new_scale_fill() +
geom_sf(data = Pad, aes(fill = Own_Name), alpha = 0.7, color = NA) +
scale_fill_manual('Management', values = plp) +
ggnewscale::new_scale_fill() +
geom_raster(data = fqi_pred_df_noXY, aes(x = x, y = y, fill = sum),
interpolate = F) +
scale_fill_viridis_c('Mean C', option = "C", direction = -1,
limits = c(1, 7) ) +
ggnewscale::new_scale_fill() +
geom_jitter(data = fqi_plots, aes(fill = mcoc_r, size = fqi_r,
geometry = geometry),
stat = "sf_coordinates", shape = 21) +
scale_fill_viridis_c('Mean C', option = "C", alpha = 0.7, direction = -1,
limits = c(1,7),  guide = "none") +
scale_size_binned('FQI') +
geom_sf(data = rivers, alpha = 0.5, color = 'blue') +
geom_sf(data = CO_roads, alpha = 0.5, color = 'black') +
coord_sf(xlim = c(bbox['xmin'], bbox['xmax']),
ylim = c(bbox['ymin'], bbox['ymax'])) +
labs(title = 'Measured and Predicted Floristic Quality') +
geom_sf_label(data = places, aes(label = NAME), inherit.aes = F,
alpha = 0.5, label.size  = NA) +
annotation_scale(location = "bl",
pad_x = unit(0.4, "in"), pad_y = unit(0.3, "in"),
width_hint = 0.2) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.3, "in"), pad_y = unit(0.5, "in"),
style = north_arrow_minimal)
fqi
fqi <- ggplot() +
geom_raster(data = hillshade, aes(x = x, y = y, fill = lyr1),
interpolate = F)  +
scale_fill_gradient(low = "grey50", high = "grey100") +
guides(fill = 'none') +
theme_void(base_size = 9) +
theme(plot.title = element_text(hjust = 0.5),
legend.title = element_text(hjust = 0.5, size = 8),
legend.position = 'bottom',
legend.key.size = unit(0.5, 'cm'),
legend.spacing.y = unit(2, 'pt'),
legend.spacing.x = unit(5, 'pt'),
legend.text = element_text(size = 6,
margin = margin(l = 0, unit = "pt"))) +
ggnewscale::new_scale_fill() +
geom_sf(data = Pad, aes(fill = Own_Name), alpha = 0.7, color = NA) +
scale_fill_manual('Management', values = plp) +
ggnewscale::new_scale_fill() +
geom_raster(data = fqi_pred_df_noXY, aes(x = x, y = y, fill = sum),
interpolate = F) +
scale_fill_viridis_c('Mean C', option = "C", direction = -1,
limits = c(1, 7) ) +
ggnewscale::new_scale_fill() +
geom_point(data = fqi_plots, aes(fill = mcoc_r, size = fqi_r,
geometry = geometry),
stat = "sf_coordinates", shape = 21) +
scale_fill_viridis_c('Mean C', option = "C", alpha = 0.7, direction = -1,
limits = c(1,7),  guide = "none") +
scale_size_binned('FQI') +
geom_sf(data = rivers, alpha = 0.5, color = 'blue') +
geom_sf(data = CO_roads, alpha = 0.5, color = 'black') +
coord_sf(xlim = c(bbox['xmin'], bbox['xmax']),
ylim = c(bbox['ymin'], bbox['ymax'])) +
labs(title = 'Measured and Predicted Floristic Quality') +
geom_sf_label(data = places, aes(label = NAME), inherit.aes = F,
alpha = 0.5, label.size  = NA) +
annotation_scale(location = "bl",
pad_x = unit(0.4, "in"), pad_y = unit(0.3, "in"),
width_hint = 0.2) +
annotation_north_arrow(location = "bl", which_north = "true",
pad_x = unit(0.3, "in"), pad_y = unit(0.5, "in"),
style = north_arrow_minimal)
fqi
ggsave(fqi, path = 'results/maps', device = 'png',
bg = 'transparent', filename = 'FQI.png',
dpi = 300, width = 6, height = 6, units = "in")
ggsave(fqi, path = 'results/maps', device = 'png',
bg = 'transparent', filename = 'FQI.png',
dpi = 300, width = 6, height = 6, units = "in")
gc()
